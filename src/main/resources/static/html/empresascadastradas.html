<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Empresas Cadastradas</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #1b4965;
        color: white;
      }

      .container {
        width: 100%;
        max-width: 90%;
        margin: 0 auto;
        padding: 20px;
        overflow-x: hidden;
      }

      h1 {
        text-align: center;
        font-size: 36px;
        font-weight: bold;
        margin-bottom: 20px;
      }

      .search-bar {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
      }

      .search-bar input {
        flex: 1;
        padding: 6px 10px;
        font-size: 14px;
        background-color: #3e4c59;
        color: white;
        border: none;
        border-radius: 4px;
        font-weight: bold;
      }

      .search-bar input::placeholder {
        color: #ddd;
      }

      .search-bar button {
        background-color: #3e4c59;
        color: white;
        font-weight: bold;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
      }

      .search-bar button:hover {
        background-color: #566372;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background-color: #3e4c59;
        color: white;
        font-size: 12px;
        table-layout: fixed;
        word-wrap: break-word;
      }

      table th,
      table td {
        border: 6px solid #2c3948;
        padding: 5px;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      table th {
        background-color: #2c3948;
        font-weight: bold;
      }

      .actions {
        text-align: center;
        margin-top: 20px;
        display: flex;
        justify-content: center;
        gap: 15px;
      }

      .actions button {
        background-color: #3e4c59;
        color: white;
        font-weight: bold;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
      }

      .actions button:hover {
        background-color: #566372;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Empresas Cadastradas</h1>

      <div class="search-bar">
        <input
          type="text"
          id="pesquisa"
          placeholder="Pesquise por empresas cadastradas"
        />
        <button onclick="pesquisar()">Pesquisar</button>
      </div>

      <table id="empresasTable">
        <thead>
          <tr>
            <th>Id</th>
            <th>Nome</th>
            <th>CNPJ</th>
            <th>CEP</th>
            <th>Endereço</th>
            <th>Cidade</th>
            <th>Bairro</th>
            <th>RH</th>
            <th>Ramo</th>
            <th>Email</th>
            <th>Filial</th>
            <th>Estagiários</th>
            <th>Funcionários</th>
            <th>Inscrição</th>
            <th>Responsável</th>
            <th>Telefones</th>
            <th>Como conheceu a Ideau</th>
            <th>Matrícula</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="actions">
        <button
          type="button"
          onclick="window.location.href='telainicial2.html'"
        >
          Cancelar
        </button>
        <button
          type="button"
          onclick="window.location.href='configuracao2.html'"
        >
          Configurações
        </button>
      </div>
    </div>

    <script>
      async function carregarEmpresas() {
        try {
          const response = await fetch("http://localhost:8080/listar-empresas");
          if (!response.ok) {
            throw new Error("Erro ao carregar empresas");
          }

          const empresas = await response.json();

          const tbody = document.querySelector("#empresasTable tbody");
          tbody.innerHTML = "";

          empresas.forEach((emp) => {
            const row = document.createElement("tr");

            row.innerHTML = `
            <td>${emp.id || ""}</td>
            <td>${emp.nome || ""}</td>
            <td>${emp.cnpj || ""}</td>
            <td>${emp.cep || ""}</td>
            <td>${emp.endereco || ""}</td>
            <td>${emp.cidade || ""}</td>
            <td>${emp.bairro || ""}</td>
            <td>${emp.rh || ""}</td>
            <td>${emp.ramo || ""}</td>
            <td>${emp.email || ""}</td>
            <td>${emp.filial || ""}</td>
            <td>${emp.estagiario || ""}</td>
            <td>${emp.funcionarios || ""}</td>
            <td>${emp.inscricao || ""}</td>
            <td>${emp.responsavel || ""}</td>
            <td>${emp.telefones || ""}</td>
            <td>${emp.como || ""}</td>
            <td>${emp.matricula || ""}</td>
          `;

            tbody.appendChild(row);
          });
        } catch (error) {
          console.error("Erro:", error);
          alert("Não foi possível carregar as empresas. Verifique o backend.");
        }
      }

      function pesquisar() {
        const termo = document.getElementById("pesquisa").value.toLowerCase();
        const linhas = document.querySelectorAll("#empresasTable tbody tr");

        linhas.forEach((linha) => {
          const nome = linha.cells[1].textContent.toLowerCase();
          linha.style.display = nome.includes(termo) ? "" : "none";
        });
      }

      window.onload = carregarEmpresas;
    </script>
  </body>
</html>
